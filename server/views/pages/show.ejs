<!DOCTYPE HTML>

<html>
<head>
    <title><%= title %></title>
    <%include ../partials/stylesheet %>
    <% include ../partials/ck %>
</head>
<body>
    <% include ../partials/nav %>
    <div class="container">
        <button id="edit" class="btn btn-primary" onclick="edit()" type="button">Edit</button>
        <button id="submit" class="btn btn-primary" onclick="submit()" type="button">Submit</button>
        <div id="editor">
            <%- data %>
        </div>
    </div>

    <script type="text/javascript">
    var edit = function(){
        BalloonEditor
           .create( document.querySelector( '#editor' ) )
           .then( editor => {
                theEditor = editor;
           })
           .catch( error => {
                console.error( error );
           });
            function getDataFromTheEditor() {
               return theEditor.getData();
           };
    };
    var submit = function(){
        var contents = theEditor.getData();
        var title = $("#editor h2").text();
        console.log(contents);
        console.log(title);
        $.ajax({
            url: '/',
            type: 'post',
            data: {"contents": contents, "title": title},
            dataType: 'JSON',
            success: function(result) //result객체 반환 되는거 봐야함.
            {
                console.log(result);
                if ( result.status == 1 ) {
                    theEditor.destroy()
                        .catch( error => {
                            console.log( error);
                        } );
                    //controller render로 처리.
                } else {
                }
            }
         })
    };
    </script>

    <% include ../partials/footer %>
    <% include ../partials/javascript %>

</body>
</html>
