<!DOCTYPE HTML>

<html>
<head>

    <title>iswiki - door</title> <!--위키 항목마다 {{ title }}이 바뀌도록 서버와 연결해야함!-->

    <link rel="stylesheet" href="extra.css">
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.7/angular.min.js"></script>
    <!-- include libraries(bootstrap) -->
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>
    <!-- include summernote css/js -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.9/summernote.css" rel="stylesheet">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.9/summernote.js"></script>
</head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html">ISWIKI</a>
            </div>
                <div id="navbar">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="index.html">Door</a></li>
                        <li><a href="search.html">Search</a></li>
                        <li><a href="list.html">List</a></li>
                        <li><a href="changed.html">Changed</a></li>
                        <li><a href="settings.html">Settings</a></li>
                        <li id="active-random"><a href="">Random</a></li>
                    </ul>
            		<form class="navbar-form navbar-right" role="search" method="POST" action="/search/">
                  	    <div class="form-group">
                    		<input id="searchbox" name="searchbox" type="text" class="form-control">
                  		</div>
                  		<button type="submit" class="btn btn-default">Search</button>
            		</form>
                </div>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1>Door ISWIKI official</h1>
        </div>
        <form method="post">
            <button id="edit" class="btn btn-primary" onclick="edit()" type="button">Edit</button>
            <button id="preview" class="btn btn-primary" onclick="preview()" type="button">Preview</button>
            <button id="submit" class="btn btn-primary"  type="button">Submit</button>
            <textarea id="editor" name="editordata"></textarea>
        </form>
        <div id="ajax-result"></div>
    </div>

    <script>

    var edit = function() {
        $('#editor').summernote({
            focus: true,
            placeholder: "Here to create."
        });
        //$('.summernote').summernote('code', contents);
    };

    var preview = function() {
        $('#editor').summernote('destroy');
    };

    $('#editor').on('input', function() {
        var title = $(this).val();
        console.log(title);
    });

    var submit = function(){
        var data = $('#editor').summernote('code');
        console.log($('#title').val());
        $.ajax({
            url: '/index.html',
            type: 'post',
            data: {"contents": data, "title": $('#title').val()},
            dataType: 'JSON',
            success: function(result)
            {
                console.log(result);
                if ( result.status == 1 ) {
                    $('#editor').summernote('destroy');
                    $('#ajax-result').html("Congrat.");
                }
            }
         })
     };

    $('#submit').on('click', function(){
         submit();
     });
    </script>
  </body>
</html>
