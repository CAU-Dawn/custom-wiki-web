<!DOCTYPE HTML>

<html>
<head>

    <title>iswiki - door</title> <!--위키 항목마다 {{ title }}이 바뀌도록 서버와 연결해야함!-->

    <link rel="stylesheet" href="extra.css">
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.7/angular.min.js"></script>
    <!-- include libraries(bootstrap) -->
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>
    <!-- include summernote css/js -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.9/summernote.css" rel="stylesheet">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.9/summernote.js"></script>
</head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html">ISWIKI</a>
            </div>
                <div id="navbar">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="index.html">Door</a></li>
                        <li><a href="search.html">Search</a></li>
                        <li><a href="list.html">List</a></li>
                        <li><a href="changed.html">Changed</a></li>
                        <li><a href="settings.html">Settings</a></li>
                        <li id="active-random"><a href="">Random</a></li>
                    </ul>
            		<form class="navbar-form navbar-right" role="search" method="POST" action="/search/">
                  	    <div class="form-group">
                    		<input id="searchbox" name="searchbox" type="text" class="form-control">
                  		</div>
                  		<button type="submit" class="btn btn-default">Search</button>
            		</form>
                </div>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1>Door ISWIKI official</h1>
        </div>
            <button id="edit" class="btn btn-primary" onclick="edit()" type="button">Edit</button>
            <button id="preview" class="btn btn-primary" onclick="preview()" type="button">Preview</button>
            <button id="submit" class="btn btn-primary" onclick="submit()" type="button">Submit</button>
            <div class="editor"></div>
            <div class="ajax-result"></div>
    </div>

    <script>
    var edit = function() {
        $('.editor').summernote({
            focus: true,
            placeholder: "Here to create."
        });
    };
    var preview = function() {
        var markup = $('.editor').summernote('code');
        $('.editor').summernote('destroy');
    };

    var submit = function(){
        var data = $('.editor').summernote('code');
        $.ajax({
            url: '/index.html',
            type: 'post',
            data: {"contents": data},
            dataType: 'html',
            success: function(result)
            {   //서버단에서는 'DB에 저장작업' 을 하고, 그게 성공적으로 처리됐다는 것을 리턴해준다.
                //그 다음 여기서 트루를 리턴받으면, 에디터가 사라지고 디스플레이가 된다.
                console.log(result.key); //<= problem.
              if ( result["key"] == true ) {
                  $('.editor').summernote('destroy');
                  $('.ajax-result').html("Congrat.");
              }
            }
         })
     }

    </script>
  </body>
</html>
