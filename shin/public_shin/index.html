<!DOCTYPE HTML>

<html>
<head>

    <title>iswiki - door</title> <!--위키 항목마다 {{ title }}이 바뀌도록 서버와 연결해야함!-->

    <link rel="stylesheet" href="extra.css">
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.7/angular.min.js"></script>
    <!-- include libraries(bootstrap) -->
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>
    <!-- include summernote css/js -->
    <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.9/summernote.css" rel="stylesheet">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.9/summernote.js"></script>
</head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html">ISWIKI</a>
            </div>
                <div id="navbar">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="index.html">Door</a></li>
                        <li><a href="search.html">Search</a></li>
                        <li><a href="list.html">List</a></li>
                        <li><a href="changed.html">Changed</a></li>
                        <li><a href="settings.html">Settings</a></li>
                        <li id="active-random"><a href="">Random</a></li>
                    </ul>
            		<form class="navbar-form navbar-right" role="search" method="POST" action="/search/">
                  	    <div class="form-group">
                    		<input id="searchbox" name="searchbox" type="text" class="form-control">
                  		</div>
                  		<button type="submit" class="btn btn-default">Search</button>
            		</form>
                </div>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1>Door ISWIKI official</h1>
        </div>
            <button id="edit" class="btn btn-primary" onclick="edit()" type="button">Edit</button>
            <button id="preview" class="btn btn-primary" onclick="preview()" type="button">Preview</button>
            <button id="submit" class="btn btn-primary" onclick="submit()" type="button">Submit</button>
            <div id="editor"></div>
            <div id="ajax-result"></div>
    </div>

    <script>

    var edit = function() {
        /*// initialize summernote
        $('.summernote').summernote();
        // and set code
        $('.summernote').summernote('code', contents);*/

        $('#editor').summernote({
            focus: true,
            placeholder: "Here to create."
        });
    };

    var preview = function() {
        $('#editor').summernote('destroy');
        //$('#editor h1').attr('id','title');
    };

    var submit = function(){
        //var title = $('#editor h1');
        //동적으로 id 삽입이 여기서는 안된다. 다른 단계에서가 필요한데.. 이게 가장 좋은 방법이니까.
        //아니면 이단계에서 추출해내는게 아예 안되는걸지도..?
        //그렇다면 preview 버튼을 강제로 누르게 해버릴까?
        var data = $('#editor').summernote('code');
        console.log($('#editor h1').html());
        $.ajax({
            url: '/index.html',
            type: 'post',
            data: {"contents": data, /*"title": title*/},
            dataType: 'JSON',
            success: function(result)
            {   //서버단에서는 'DB에 저장작업' 을 하고, 그게 성공적으로 처리됐다는 것을 리턴해준다.
                console.log(result);
                if ( result.status == 1 ) {
                    $('#editor').summernote('destroy');
                    $('#ajax-result').html("Congrat.");
                }
            }
         })
     }
    //부분편집기능(h2하위p), 내부검색기능+팝업에디팅(가장중요)
    //이미지화 빅데이터모델링(해쉬태그기반 또는 텍스트 트랙킹)=>메인페이지.
    //메인페이지 토킹api 퀘스쳔 및 프로젝트구인 으로 활용.
    </script>
  </body>
</html>
